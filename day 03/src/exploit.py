from bs4 import BeautifulSoup

with open('../materials/evilcorp.html', 'r') as f:
    html = f.read()

soup = BeautifulSoup(html, 'html.parser')

title_tag = soup.find('title')
title_tag.string.replace_with('Evil Corp - Stealing your money every day')

hacked_title = ', you are hacked!'

pronoun_span = soup.find('span', class_='pronoun')
name_span = soup.find('span', class_='name')
name_span.string = 'Robot'

hacked_tag = soup.new_tag('h1')
hacked_tag.append(pronoun_span)
hacked_tag.append(name_span)
hacked_tag.append(hacked_title)
soup.body.insert(0, hacked_tag)

script_tag = soup.new_tag('script')
script_tag.string = """
hacked = function() {
    alert('hacked');
}
window.addEventListener('load', 
  function() { 
    var f = document.querySelector("form");
    f.setAttribute("onsubmit", "hacked()");
  },
  false
);
"""
soup.body.append(script_tag)
link_tag = soup.find('a', href='https://mrrobot.fandom.com/wiki/E_Corp')
link_tag['href'] = 'https://mrrobot.fandom.com/wiki/Fsociety'
link_tag.string.replace_with('Fsociety')

with open('../materials/evilcorp_hacked.html', 'w') as f:
    f.write(str(soup))
